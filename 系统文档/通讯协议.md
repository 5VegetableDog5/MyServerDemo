# 通讯协议

## 帧头

帧头为两个字节；

1. 第一个字节（指令类型）：

   - 如果是0x00;表示接收的是控制指令；
   - 如果是0x01;表示接收的是一串数据;

2. 第二个字节（）

   - 如果第一个字节是0x00(控制指令)：

     a. 0x00；注册指令；在服务器上注册（上线）；

     b. 0x01；拨号指令；如果是该指令，服务器后面将会继续接收数据帧获取通话目标的IP地址；

     c. 0xCF；挂断指令；停止当前通话；

     d. 0x03；下线指令；
   
     
   
   - 如果第一个字节是0x01(数据帧)
   
     a. 0x00；表示音频数据帧的长度且长为为4096个字节；
     
     b. 0x01；测试用，表示数据帧长度为16个字节；
     
     c. 0x02；表示IP数据帧，长度为15个字节；注：格式要求：192.168.001.002;（每个IP地址的数字必须要三位数，不足的在前面加0）

## 数据帧

暂无补充；



## 例程

### 1.拨号

1. 两个客户端分别发送00 00以注册
2. 拨号方发送00 01表示自己接下来要拨号
3. 拨号方发送“192.168.001.002” 表示拨号的IP地址为该IP地址
4. 接下来发送01 00 + 音频数据帧即可将音频传输至目标IP地址

### 2.挂断

如果当前正在通话中，则在发送完上一帧音频数据后发送00 CF即可

### 3.下线

- 如果当前正在通话中，则在发送完上一帧音频数据后发送00 03即可
- 如果当前是空闲状态则直接发送00 03


#协议（发给设备）
##帧头（半字）
1. 首字节（类型）：

   - 0x00：指令帧
   - 0x11：数据帧

2. 次字节
   
   指令帧（0x00)
   - 0x01：来电
   - 0x10：挂机

   数据帧（0x11)
   - 0x11：后接数据

